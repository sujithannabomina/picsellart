import{u as m,r as n,j as e}from"./index-C0VzZSJe.js";import{u as h,q as p,c as y,d as f,o as x,g}from"./AuthContext-XHCfx8-r.js";function j(a){try{return a?(a.toDate?a.toDate():new Date(a)).toLocaleString():"—"}catch{return"—"}}function b(){const{user:a}=h(),r=m(),[t,c]=n.useState(null),[o,i]=n.useState(!0);return n.useEffect(()=>{if(!a){r("/buyer/login");return}(async()=>{try{const s=p(y(f,"buyers",a.uid,"purchases"),x("createdAt","desc")),u=(await g(s)).docs.map(l=>({id:l.id,...l.data()}));c(u)}catch(s){console.error(s),c([])}finally{i(!1)}})()},[a,r]),a?e.jsx("main",{className:"section",children:e.jsxs("div",{className:"container",children:[e.jsx("h1",{className:"page-title",children:"Your purchases"}),e.jsx("p",{className:"page-desc",children:"Downloaded photos and license details."}),o?e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:"Loading…"})}):(t?.length??0)===0?e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:"No purchases yet."})}):e.jsx("div",{className:"grid grid--3",style:{marginTop:16},children:t.map(s=>e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"muted",style:{fontSize:13,marginBottom:4},children:["Order: ",s.orderId||s.id]}),e.jsx("h3",{style:{fontSize:16,fontWeight:600,marginBottom:6},children:s.title||"Photo"}),e.jsxs("div",{className:"muted",style:{fontSize:13},children:["Date: ",j(s.createdAt)]}),e.jsxs("div",{className:"muted",style:{fontSize:13},children:["Amount: ₹",(s.amount??0)/100," ",s.currency||"INR"]}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("a",{className:`btn ${s.hdUrl?"btn--brand":""}`,href:s.hdUrl||"#",target:"_blank",rel:"noreferrer",onClick:d=>{s.hdUrl||d.preventDefault()},children:s.hdUrl?"Download HD":"Download not ready"}),e.jsx("button",{className:"btn",onClick:()=>window.open("/policy","_blank"),children:"License Policy"})]})]})},s.id))})]})}):null}export{b as default};
