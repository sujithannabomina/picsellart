import{u as d,r as c,j as e,a as u}from"./index-C0VzZSJe.js";import{u as h}from"./AuthContext-XHCfx8-r.js";import{c as m,l as p}from"./loadRazorpay-C47nwxjB.js";function y(){const{state:s}=u();return s?.photo??null}function x({value:s}){return s==null?e.jsx("span",{className:"muted",children:"—"}):e.jsxs("span",{style:{fontWeight:800},children:["₹",s]})}function b(){const s=y(),r=d(),{user:i}=h(),[t,l]=c.useState(!1),n=c.useMemo(()=>s?.watermarkedUrl||s?.thumbUrl||s?.publicUrl||"",[s]);async function o(){if(s){if(!i){r("/buyer/login",{replace:!0});return}try{l(!0);const a=await m({amount:Number(s.price)*100,currency:"INR",userId:i.uid,purchaseType:"photo",photoId:s.id,sellerId:s.ownerId||"picsellart",title:s.title||"Photo",isSample:!!s.isSample});await p({order:a,user:i,onSuccess:()=>{alert("Payment successful! Your HD download will be available in your dashboard."),r("/buyer/dashboard")}})}catch(a){console.error("Buy failed:",a),alert("Unable to start payment. Please try again.")}finally{l(!1)}}}return s?e.jsx("main",{className:"section",children:e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"card",style:{overflow:"hidden"},children:e.jsxs("div",{className:"card-body",style:{display:"grid",gridTemplateColumns:"1.2fr 1fr",gap:24},children:[e.jsx("div",{children:n?e.jsx("img",{src:n,alt:s.title||"Photo",style:{width:"100%",height:"auto",borderRadius:12}}):e.jsx("div",{className:"skeleton",style:{height:420}})}),e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",style:{fontSize:28},children:s.title||"Untitled"}),e.jsx("p",{className:"muted",style:{marginTop:6},children:s.ownerName?`By ${s.ownerName}`:s.isSample?"Picsellart Sample":"Seller"}),e.jsxs("div",{style:{marginTop:18,fontSize:18},children:["Price: ",e.jsx(x,{value:s.price})]}),Array.isArray(s.tags)&&s.tags.length>0?e.jsx("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:s.tags.map(a=>e.jsx("span",{className:"badge",children:a},a))}):null,e.jsxs("div",{style:{marginTop:20,display:"flex",gap:10},children:[e.jsx("button",{className:"btn btn--brand",onClick:o,disabled:t,children:t?"Processing…":"Buy & Download HD"}),e.jsx("button",{className:"btn",onClick:()=>r(-1),children:"Back"})]}),e.jsxs("div",{className:"muted",style:{marginTop:14,fontSize:13},children:["• Watermark will be removed after successful purchase.",e.jsx("br",{}),"• Purchased images appear in your Buyer Dashboard with invoice & license info."]})]})]})}),e.jsx("div",{className:"card",style:{marginTop:20},children:e.jsxs("div",{className:"card-body",children:[e.jsx("h3",{style:{fontSize:18,fontWeight:800,marginBottom:6},children:"License & Usage"}),e.jsxs("p",{className:"muted",children:["This purchase grants a standard license to use the image for personal or commercial projects according to our ",e.jsx("a",{href:"/policy",className:"link",children:"policy"}),". Redistribution or resale is not permitted. For extended licenses, contact us via the",e.jsx("a",{href:"/contact",className:"link",children:" contact page"}),"."]})]})})]})}):e.jsx("main",{className:"section",children:e.jsx("div",{className:"container card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h1",{className:"page-title",children:"Photo not found"}),e.jsx("p",{className:"page-desc",children:"This photo link appears to be invalid or missing."}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:()=>r("/explore"),children:"Back to Explore"})})]})})})}export{b as default};
