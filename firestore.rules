rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // ✅ Items collection - PUBLIC READ (anyone can browse)
    match /items/{itemId} {
      allow read: if true; // Anyone can read (for Explore page)
      allow write: if false; // Only backend can write
    }
    
    // ✅ Purchases - PRIVATE (only buyer can read their own)
    match /purchases/{purchaseId} {
      allow read: if request.auth != null && 
                     resource.data.buyerUid == request.auth.uid;
      allow write: if false; // Only backend can write
    }
    
    // ✅ Sellers - PRIVATE (only seller can read their own)
    match /sellers/{sellerId} {
      allow read: if request.auth != null && 
                     request.auth.uid == sellerId;
      allow write: if false; // Only backend can write
    }
    
    // ✅ Buyers - PRIVATE (only buyer can read their own)
    match /buyers/{buyerId} {
      allow read: if request.auth != null && 
                     request.auth.uid == buyerId;
      allow write: if false; // Only backend can write
    }
    
    // ✅ Users - PRIVATE
    match /users/{userId} {
      allow read: if request.auth != null && 
                     request.auth.uid == userId;
      allow write: if false;
    }
  }
}
